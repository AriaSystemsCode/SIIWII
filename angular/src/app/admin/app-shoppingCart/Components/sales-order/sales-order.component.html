<div class="orderForm  position-relative">
    <div class="container-fluid orderInfoForm thin-scroll">
        <div
            class="header p-2  d-flex align-items-center  justify-content-end"
        >
            <!-- <h6><span class="headertxt"> Entered By : </span> {{ fullName }}</h6> -->

            <button
                [disabled]="!(isContactsValid && isSalesOrderValidForm())"
                *ngIf="createOrEditorderInfo && !showSaveBtn"
                (click)="createOrEditTransaction()"
                class="continuebtn text-center btn float-right"
            >
                Continue
            </button>
     
       
 
        </div>
        <!-- <hr class="my-2" /> -->
        <div class="row ">
            <h6 class="col-6 mt-4" ><span class="headertxt previewTitle ml3"> Entered By : </span></h6>
            <div class="col-6"    *ngIf="!createOrEditorderInfo &&  !showSaveBtn &&  canChange">
                <button
             
                (click)="showEditMode()"
                class="previewbtn text-center btn float-right"
            >
            
            
            <img src="../../../../../assets/shoppingCart/edit.png"
            class="imgIcon" style="position: relative;right: 0 !important;bottom: 0 !important;"/>
            <span class="mx-1 text-white"> Edit</span>

            </button>
            </div>
            <div *ngIf="createOrEditorderInfo" class="formGroup  col-md-6 col-12">
                <label class="label">Reference #</label>
                <input
                
                    type="text"
                    placeholder="Reference Number"
                    class="form-control "
                    style="width: 95% !important;"
                    [(ngModel)]="reference"
                />
             
           
            </div>
        </div>
        <hr   *ngIf="!createOrEditorderInfo " class="my-2" />

        <div class="pr-3">
            <app-contact
            class="w-100"
            [isCreateOrEdit]="createOrEditorderInfo"
                [activeTab]="activeTab"
                [currentTab]="currentTab"
                [appTransactionsForViewDto]="appTransactionsForViewDto"
                (formValidityChanged)="isContactFormValid($event)"
                (updateAppTransactionsForViewDto)="onUpdateAppTransactionsForViewDto($event)"
                [showDepartment]="activeTab == shoppingCartoccordionTabs.BuyerContactInfo"
            ></app-contact>

            <div class="row">
                <div *ngIf="!createOrEditorderInfo" class="col-md-6 col-12 mt-3">
                 
                        <div
                            class="d-flex align-items-center   w-100"
                        >
                            <h6 class="previewTitle  m-0 p-0 col-6 my-2">Reference Number:</h6>
                            <p class="previewValue  m-0 p-0 col-6 my-2">
                                {{ appTransactionsForViewDto?.reference }}
                            </p>
                        </div>
                  
</div>
                <!-- classification -->
                <div class="col-md-12 mt-3">
                    <div *ngIf="createOrEditorderInfo" class="d-flex flex-column">
                      <div class="d-flex"> <label class="label pt-1">Classifications</label>  <div class="d-flex p-y-1 px-4 rounded  cat"> <span class="mr-2">+</span> Add Classification</div></div> 





                      <!-- if has selection -->
                        <!-- <div
                            class="align-items-center big-scroll categoriesClassificationsContainer px-3 py-2 d-flex h-100 row   w-100 border"
                        >
                            <p
                                class="previewValue classificationsValues mr-2 p-0 my-0"
                                *ngFor="
                                    let item of appTransactionsForViewDto?.entityClassifications
                                "
                            >
                                {{ item?.entityObjectClassificationName }}
                                <span 
                                (click)="classififcationNodeUnSelect(item)">
                                <i class="flaticon2-delete fa-sm pl-2 pointer"></i>
                            </span>
                            </p>
                            <p
                                *ngIf="
                                !appTransactionsForViewDto?.entityClassifications  ||   appTransactionsForViewDto?.entityClassifications
                                        ?.length === 0
                                "
                                class="p-0 m-0 customPlaceHolder"
                            >
                                Please select Classification From Tree below
                            </p>
                        </div> -->
                        <!-- <div class="border">
                            <p-tree
                                class="w-full md:w-30rem"
                                [value]="classificationsFiles"
                                (onNodeExpand)="
                                    classificationNodeExpand($event)
                                "
                                [loading]="loading"
                                selectionMode="checkbox"
                                (onNodeSelect)="
                                    classififcationNodeSelect($event)
                                "
                            ></p-tree>
                        </div> -->
                    </div>
                    <div *ngIf="!createOrEditorderInfo">
                        <div
                            class="align-items-center big-scroll categoriesClassificationsContainer px-3  d-flex h-100 row   w-100 "
                        >
                            <h6 class="previewTitle  m-0 p-0 pr-2 my-2">
                                Classifications :
                            </h6>
                            <p
                                class="previewValue classificationsValues  m-0 p-0  my-2"
                                *ngFor="
                                    let item of appTransactionsForViewDto?.entityClassifications
                                "
                            >
                                {{ item?.entityObjectClassificationName}}
                            </p>
                            <p
                                class="previewValue m-0 p-0 col-md-6 col-12 my-2"
                                *ngIf="
                             !appTransactionsForViewDto?.entityClassifications  ||  appTransactionsForViewDto?.entityClassifications
                                    ?.length === 0
                            "
                            >
                                -
                            </p>
                        </div>
                    </div>
                </div>
                <!-- classification -->

                <!-- categories -->
                <app-codes *ngIf="!(category?.id>0)"
                    [objectType]="entityObjectType"
                    [editMode]=false
                    (getCodeValue)="getCodeValue($event)" ></app-codes>

                    <app-codes *ngIf="category?.id>0"
                     [objectType]="entityObjectType"
                     [editMode]=true
                     [code]="category?.code"
                     (getCodeValue)="getCodeValue($event)" ></app-codes>
                <div class="col-md-12 mt-3">
                    <!-- (click)="showCatBtn = true"  -->
                    <div *ngIf="createOrEditorderInfo" class="d-flex flex-column">
                        <div class="d-flex"> <label class="label pt-1">Classifications</label>  <div *ngIf="allRecords.length == 0 " class="d-flex p-y-1 px-4 rounded  cat"> <span class="mr-2">+</span> Add Categories</div></div> 

                          <!-- <div class="d-flex" *ngIf="showCatBtn || allRecords.length == 0 ">
                            <div  class="formGroup  col-8">
                              
                                <input
                                
                                    type="text"
                                    placeholder="Category"
                                    class="form-control "
                                    style="width: 95% !important;"
                                    [(ngModel)]="category.name"
                                    
                                />
                             
                           
                            </div>
                            <button
                           
                         
                           (click)="saveCat(category);hideCatBtn =true;showCatBtn = false"
                            class="previewbtn text-center btn "
                        >
                            Save
                       
                        </button>
                        <button
                        (click)="cancelCat()"
                        class="cancelbtn text-center btn "
                        >
                        Cancel
                       
                        </button>
                         </div> -->

<!-- <div class="d-flex" *ngIf="!showCatBtn && appTransactionsForViewDto?.entityCategories
?.length === 0">
    <p
    class="previewValue classificationsValues  m-0 p-0  my-2"
    *ngFor="
        let item of selectedCategories
    "
>
    {{ item?.entityObjectCategoryName}}
</p>

            <p
            class="previewValue classificationsValues  m-0 p-0  my-2"
            *ngFor="
                let item of appTransactionsForViewDto?.entityCategories
            "
            >
            {{ item?.entityObjectCategoryName}}
            </p>
</div> -->


                        <!-- if no selection -->
                        <!-- <div
                            class="categoriesClassificationsContainer  big-scroll  h-100 row align-tems-center border flex-row px-3 py-2 rounded row thin-scroll w-100 border"
                        >
                            <p
                                class="previewValue categoriesValues mr-2 p-0"
                                *ngFor="
                                    let item of appTransactionsForViewDto?.entityCategories
                                "
                            >
                                {{ item?.entityObjectCategoryName }}
                                <span 
                                (click)="categoriesNodeUnSelect(item)">
                                <i class="flaticon2-delete fa-sm pl-2 pointer"></i>
                            </span>
                            </p>
                            <p
                                *ngIf="
                                !appTransactionsForViewDto?.entityCategories  ||  appTransactionsForViewDto?.entityCategories
                                        ?.length === 0
                                "
                                class="p-0 m-0 customPlaceHolder"
                            >
                                Please select Categories From Tree below
                            </p>
                        </div>
                        <div class="border">
                            <p-tree
                                class="w-full md:w-30rem"
                                [value]="categoriesFiles"
                                (onNodeExpand)="categoriesNodeExpand($event)"
                                [loading]="loading"
                                selectionMode="checkbox"
                                (onNodeSelect)="categoriesNodeSelect($event)"

                            ></p-tree>
                        </div>
                         -->
                      
                        <!-- <p-treeSelect
                            class="md:w-20rem w-full"
                            containerStyleClass="w-full"
                            [(ngModel)]="selectedCategories"
                            selectionMode="checkbox"
                            [options]="categoriesFiles"
                            placeholder="Select Item..."
                            (onNodeExpand)="categoriesNodeExpand($event)"
                            (onNodeSelect)="categoriesNodeSelect($event)"
                        ></p-treeSelect> -->
                        <!-- &&  (appTransactionsForViewDto?.entityCategories  ||  appTransactionsForViewDto?.entityCategories
                        ?.length === 0) -->
                        <!-- <div *ngIf="selectedCategories && selectedCategories.length > 0 && showSelectedCat" class="selected-items-container">
                            <div *ngFor="let item of selectedCategories" class="selected-item">
                                <span>{{ item.label }}</span>
                            </div>
                        </div> -->
<div class="d-flex" *ngIf=" allRecords.length != 0">
    <!-- {{selectedCategories}} -->
                    <!-- Selected Items Display -->


<!-- TreeSelect Component -->
<!-- <div *ngIf="!showCatBtn"  class="flex justify-content-center treeSel"   style="z-index:9999999999 !important ;" >
    <p-treeSelect 
    class="w-full md:w-20rem"
    containerStyleClass="w-full"
    [(ngModel)]="selectedCategories"
    [options]="allRecords"
    display="chip"
    [metaKeySelection]="false"
    selectionMode="checkbox"
    placeholder="Select Item"
    [filter]="true"
    filterPlaceholder="Search Items"
    (click)="categoriesNodeSelect($event)"
    (onNodeExpand)="onNodeToggle($event, true)"
    (onNodeCollapse)="onNodeToggle($event, false)"
    >

    <ng-template pTemplate="default">
        <div class="header p-2 d-flex align-items-center justify-content-between">
            <div>
                <input type="checkbox" (change)="toggleSelectAll($event)" /> Select All
            </div>
            <button class="btn btn-link" (click)="collapseAll()">Collapse All</button>
        </div>
    </ng-template>
        <ng-template let-node pTemplate="default">
            <div (click)="onLabelClick($event)" class="d-flex justify-content-between">
                <span  >{{ node.label }}</span>
                <div class="dropdown" dropdown>
                    <button
                        class="btn btn-secondary dropdown-toggle p-0"
                        type="button"
                        id="dropdownMenuButton"
                        data-toggle="dropdown"
                        aria-haspopup="true"
                        aria-expanded="false"
                        dropdownToggle
                    >
                        <div class="three-dots"></div>
                    </button>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton" *dropdownMenu>
                        <div class="pointer">
                            <a class="link purpleColor p-3" (click)="EditCat(node)">
                                <img
                                    src="../../../../../assets/shoppingCart/Order-Details-Table-Delete_Btn.svg"
                                    class="imgIcon"
                                />
                                {{ 'Edit' }}
                            </a>
                        </div>
                        <div class="pointer">
                            <a class="link purpleColor p-3" (click)="addAsNewChild(node)">
                                <img
                                    src="../../../../../assets/shoppingCart/Order-Details-Table-Delete_Btn.svg"
                                    class="imgIcon"
                                />
                                {{ 'Add SubCategory' }}
                            </a>
                        </div>
                        <div class="pointer">
                            <a class="link purpleColor p-3" (click)="deleteCat(node)">
                                <img
                                    src="../../../../../assets/shoppingCart/Order-Details-Table-Delete_Btn.svg"
                                    class="imgIcon"
                                />
                                {{ 'Delete' }}
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </ng-template>

        <ng-template let-last pTemplate="footer">
            <div class="d-flex justify-content-end p-2">
                <button class="btn bgPurple" (click)="saveSelection()">Save</button>
                <button class="btn btn-secondary" (click)="cancelSelection()">Cancel</button>
            </div>
        </ng-template>
    </p-treeSelect>
</div> -->

                  
                        <!-- <button *ngIf="!showCatBtn" (click)="showCatBtn = true" class="d-flex p-y-1 px-4 rounded cat"> <span class="mr-2">+</span> Add Categories</button>
                    </div>
                    </div> -->
                    <div *ngIf="!createOrEditorderInfo">
                        <div
                            class="categoriesClassificationsContainer d-flex align-items-center big-scroll px-3    h-100 row   w-100"
                        >
                            <h6 class="previewTitle  m-0 p-0 pr-2 my-2">Categories :</h6>
                            <p
                                class="previewValue classificationsValues  m-0 p-0  my-2"
                                *ngFor="
                                    let item of appTransactionsForViewDto?.entityCategories
                                "
                            >
                                {{ item?.entityObjectCategoryName}}
                            </p>

                    
                            <p
                                class="previewValue   m-0 p-0 col-6 my-2"
                                *ngIf="
                                !appTransactionsForViewDto?.entityCategories  || appTransactionsForViewDto?.entityCategories
                                    ?.length === 0
                            "
                            >
                                -
                            </p>
                        </div>
                    </div>
                </div>
                <!-- categories -->

                <!-- dates -->
                <div class="col-md-6 mt-3 position-relative">
                    <div *ngIf="createOrEditorderInfo">
                        <label class="label">Entered Date</label>
                        <div class="">
                            <p-calendar
                            appendTo="body"
                                [(ngModel)]="enteredDate"
                                [showIcon]="true"
                                (ngModelChange)="onChangeDate()"
                            ></p-calendar>
                           
                        <img src="../../../../../assets/icons/calendar.png"    alt="" srcset="">

                        </div>
                    </div>
                    <div *ngIf="!createOrEditorderInfo">
                        <div
                            class="d-flex align-items-center   w-100"
                        >
                            <h6 class="previewTitle  m-0 p-0 col-6 my-2">Entered Date :</h6>
                            <p class="previewValue  m-0 p-0 col-6 my-2">
                                {{ appTransactionsForViewDto?.enteredDate?.toString() | date : "MM/dd/yyyy  " }}
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 mt-3 position-relative">
                    <div *ngIf="createOrEditorderInfo">
                        <label class="label">Start Date</label>
                        <p-calendar
                        appendTo="body"
                            [(ngModel)]="startDate"
                            [showIcon]="true"
                            (ngModelChange)="onChangeDate()"
                        ></p-calendar>
                        <img src="../../../../../assets/icons/calendar.png"   alt="" srcset="">

                    </div>
                    <div *ngIf="!createOrEditorderInfo">
                        <div
                            class="d-flex align-items-center   w-100"
                        >
                            <h6 class="previewTitle  m-0 p-0 col-6 my-2">Start Date :</h6>
                            <p class="previewValue  m-0 p-0 col-6 my-2">
                                {{ appTransactionsForViewDto?.startDate?.toString() | date : "MM/dd/yyyy "}}
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 mt-3 position-relative">
                    <div *ngIf="createOrEditorderInfo">
                        <label class="label">Avaialable Date</label>
                        <p-calendar
                        appendTo="body"
                            [(ngModel)]="availableDate"
                            [showIcon]="true"
                            (ngModelChange)="onChangeDate()"
                            [minDate]="completeDate"
                        ></p-calendar>
                        <img src="../../../../../assets/icons/calendar.png"   alt="" srcset="">

                    </div>
                    <div *ngIf="!createOrEditorderInfo">
                        <div
                            class="d-flex align-items-center   w-100"
                        >
                            <h6 class="previewTitle  m-0 p-0 col-6 my-2">
                                Avaialable Date :
                            </h6>
                            <p class="previewValue  m-0 p-0 col-6 my-2">
                                {{ appTransactionsForViewDto?.availableDate?.toString() | date : "MM/dd/yyyy " }}
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 mt-3 position-relative">
                    <div *ngIf="createOrEditorderInfo">
                        <label class="label">Complete Date</label>
                        <p-calendar
                        appendTo="body"
                            [(ngModel)]="completeDate"
                            [showIcon]="true"
                            (onSelect)="changeCompleteDate(completeDate)"
                            (ngModelChange)="changeCompleteDate(completeDate)"
                            [minDate]="startDate"
                        ></p-calendar>
                        <img src="../../../../../assets/icons/calendar.png"   alt="" srcset="">

                    </div>
                    <div *ngIf="!createOrEditorderInfo">
                        <div
                            class="d-flex align-items-center   w-100"
                        >
                            <h6 class="previewTitle  m-0 p-0 col-6 my-2">
                                Complete Date :
                            </h6>
                            <p class="previewValue  m-0 p-0 col-6 my-2">
                                {{ appTransactionsForViewDto?.completeDate?.toString() | date : "MM/dd/yyyy " }}
                            </p>
                        </div>
                    </div>
                </div>
                <!-- dates -->
              
                <!-- currency -->
                <div class="col-md-6 mt-3">
                    <div *ngIf="createOrEditorderInfo">
                        <label class="label">Currency</label>
                        <p-dropdown
                            [options]="currencies"
                            [(ngModel)]="selectedCurrency"
                            optionLabel="code"
                            optionValue="value"
                            class="w-100"
                            (onChange)="onchangeCurrency()"
                        ></p-dropdown>
                    </div>
                    <div *ngIf="!createOrEditorderInfo">
                        <div
                            class="d-flex align-items-center  "
                        >
                            <h6 class="previewTitle  m-0 p-0 col-md-6 col-12 my-2">Currency :</h6>
                            <p class="previewValue  m-0 p-0 col-md-6 col-12 my-2">
                                {{ appTransactionsForViewDto?.currencyCode }}
                            </p>
                        </div>
                    </div>
                </div>
                <!-- currency -->

                <!-- exchange rate -->
                <div class="col-md-6 mt-3">
                    <div *ngIf="createOrEditorderInfo" class="formGroup">
                        <label class="label">Exchange Rate</label>
                        <input
                        [readonly]="appTransactionsForViewDto?.currencyExchangeRate && appTransactionsForViewDto?.currencyExchangeRate >0"
                            type="text"
                            placeholder="Exchange Rate..."
                            class="form-control w-100"
                            [(ngModel)]="appTransactionsForViewDto.currencyExchangeRate"
                        />
                    </div>
                    <div *ngIf="!createOrEditorderInfo">
                        <div
                            class="d-flex align-items-center   w-100"
                        >
                            <h6 class="previewTitle  m-0 p-0 col-md-6 col-12 my-2">
                                Exchange Rate :
                            </h6>
                            <p class="previewValue  m-0 p-0 col-md-6 col-12 my-2">
                                {{ appTransactionsForViewDto?.currencyExchangeRate }}
                            </p>
                        </div>
                    </div>
                </div>
                <!-- exchange rate -->
            </div>
        </div>
        <hr class="my-2" />
        <div class="d-flex justify-content-end">

    <button
    *ngIf="showSaveBtn"
    [disabled]="!(isContactsValid && isSalesOrderValidForm())"
    (click)="save()"
    class="previewbtn text-center btn float-right"
>
    Save
    <!-- <i class="pi pi-check"></i> -->
</button>
<button
*ngIf="showSaveBtn"
(click)="cancel()"
class="cancelbtn text-center btn float-right"
>
Cancel
<!-- <i class="pi pi-times"></i> -->
</button>
</div>
    </div>
</div>
